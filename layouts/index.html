{{ define "main" }}
<main class="md:mt-12 grid dd-grid-cols gap-y-10 md:gap-y-12 grid-flow-row">
  <header class="col-span-full flex flex-col items-center text-center">
    <figure class="w-48 h-48 overflow-hidden rounded-full">
      <picture>
        <img src="https://res.cloudinary.com/demaree/image/upload/w_384,h_384/v1608507912/demaree-dot-me/images/david-avatar-2020.jpg" width="384" height="384" alt="David Demaree" />
      </picture>
    </figure>
    <div class="max-w-xl my-8">
      {{ .Content }}
    </div>
    <div class="text-inkBold">
      {{ partial "site/social-nav.html" . }}
    </div>
  </header>

  <h2 class="text-center uppercase tracking-widest font-semibold text-inkBold text-xl dd-col-wide mt-8">Latest writing</h2>

  {{- range first 8 (partial "data/home-page-posts.html" .) -}}
  {{- $permalink := .URL -}}
  <article class="flex items-center dd-col-wide md:dd-col-content">
    <div class="flex-1">
      <a href="{{ .URL }}" class="block">
        <h2 class="deorphan text-inkBold font-semibold text-lg sm:text-xl leading-tight sm:leading-tight">{{ .Title }}</h2>
        {{ with .Description }}<div class="text-sm mt-2">{{ . }}</div>{{ end }}
        <div class="text-inkMedium text-sm mt-2">{{ .Date.Format "Jan 2, 2006" }}</div>
      </a>
    </div>
    {{ if .featured_image }}
    {{ $featuredImageUrl := urls.Parse .featured_image }}
    <a href="{{ .URL }}" class="w-24 sm:w-32 h-24 ml-8 overflow-hidden rounded-md">
      {{ if $featuredImageUrl.Scheme }}
        {{ if eq $featuredImageUrl.Host "images.unsplash.com" }}
        <img src="https://res.cloudinary.com/demaree/image/fetch/w_320,h_192,c_fill/{{ .featured_image }}%3Fw=320" width="160" height="96" alt="Featured image for post" class="object-cover object-center h-full w-full" />
        {{ else }}
        <img src="https://res.cloudinary.com/demaree/image/fetch/w_320,h_192,c_fill/{{ .featured_image }}" width="160" height="96" alt="Featured image for post" class="object-cover object-center h-full w-full" />
        {{ end }}
      {{ else }}
        <img src="{{ .featured_image }}" width="160" height="96" alt="Featured image for post" class="object-cover object-center h-full w-full" />
      {{ end }}
    </a>
    {{ end }}
  </article>
  {{ end }}

</main>
{{ end }}